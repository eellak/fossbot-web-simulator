[gd_scene load_steps=29 format=2]

[ext_resource path="res://car.gd" type="Script" id=1]
[ext_resource path="res://square.jpg" type="Texture" id=2]
[ext_resource path="res://assets/fossbot.tres" type="ArrayMesh" id=3]
[ext_resource path="res://assets/wheel.tres" type="ArrayMesh" id=4]
[ext_resource path="res://environment.gd" type="Script" id=5]
[ext_resource path="res://camera.gd" type="Script" id=6]

[sub_resource type="CubeMesh" id=1]
size = Vector3( 100, 1, 100 )

[sub_resource type="SpatialMaterial" id=8]
flags_world_triplanar = true
albedo_texture = ExtResource( 2 )
uv1_triplanar = true

[sub_resource type="ConcavePolygonShape" id=10]
data = PoolVector3Array( -50, 0.5, 50, 50, 0.5, 50, -50, -0.5, 50, 50, 0.5, 50, 50, -0.5, 50, -50, -0.5, 50, 50, 0.5, -50, -50, 0.5, -50, 50, -0.5, -50, -50, 0.5, -50, -50, -0.5, -50, 50, -0.5, -50, 50, 0.5, 50, 50, 0.5, -50, 50, -0.5, 50, 50, 0.5, -50, 50, -0.5, -50, 50, -0.5, 50, -50, 0.5, -50, -50, 0.5, 50, -50, -0.5, -50, -50, 0.5, 50, -50, -0.5, 50, -50, -0.5, -50, 50, 0.5, 50, -50, 0.5, 50, 50, 0.5, -50, -50, 0.5, 50, -50, 0.5, -50, 50, 0.5, -50, -50, -0.5, 50, 50, -0.5, 50, -50, -0.5, -50, 50, -0.5, 50, 50, -0.5, -50, -50, -0.5, -50 )

[sub_resource type="ConvexPolygonShape" id=4]
points = PoolVector3Array( -0.7225, -0.25, -1.43083, 0.694167, 0.25, 1.37472, -0.694167, 0.25, 1.37472, 0.7225, -0.25, 1.43083, 0.694167, 0.25, -1.37472, -0.7225, -0.25, 1.43083, 0.7225, -0.25, -1.43083, -0.694167, 0.25, -1.37472 )

[sub_resource type="SphereMesh" id=9]
radius = 0.2
height = 0.5

[sub_resource type="SpatialMaterial" id=17]
albedo_color = Color( 0.643137, 0.643137, 0.643137, 1 )

[sub_resource type="CylinderMesh" id=11]
top_radius = 5.0
bottom_radius = 0.0
height = 7.0
radial_segments = 32

[sub_resource type="ConvexPolygonShape" id=12]
points = PoolVector3Array( 4.30252, 2.53948, 0.115669, -0.699977, 3.13137, -4.66773, -0.346886, 2.87896, -4.52223, -3.82644, 3.32882, 2.98923, -0.115517, -3.27129, 0.115517, 2.66171, 3.36847, 4.11338, -4.11339, 3.36847, -2.66172, 3.25237, 3.48377, -3.75296, -0.724197, 3.36082, 4.82924, -4.82924, 3.36082, 0.724197, 4.41537, 3.32301, 2.02823, 0.115517, -3.27129, -0.115517, 4.41535, 3.323, -2.02822, -2.66171, 3.36847, -4.11338, 3.25237, 3.48377, 3.75296, 1.32079, 3.34166, -4.68154, -2.66172, 3.36847, 4.11339, 0.724197, 3.36082, 4.82924, -4.82924, 3.36082, -0.724197, -0.115517, -3.27129, -0.115517, 0.115517, -3.27129, 0.115517, 4.83034, 3.36225, -0.723416, -4.41452, 3.32171, 2.02784, -1.6881, 3.35617, -4.5809, 2.66172, 3.36847, -4.11339, 4.11492, 3.3704, 2.66176, 4.11491, 3.37039, -2.66175, 4.83034, 3.36225, 0.723416, -1.6881, 3.35617, 4.5809, -3.20299, 2.84086, -3.20209, -4.01221, 2.61737, -1.71837, 1.71897, 2.61691, 4.01152, 0.724197, 3.36082, -4.82924, -3.20299, 2.84086, 3.20209, -4.11338, 3.36847, 2.66171, -4.30252, 2.53948, 0.115669, 0.115648, 2.53838, 4.30173, 1.71897, 2.61692, -4.01153, 3.20225, 2.8402, -3.20225, 3.20225, 2.8402, 3.20225, 4.68294, 3.34333, -1.32025, 4.68294, 3.34332, 1.32025, -4.68282, 3.34325, 1.32048, -0.814091, -2.34434, -0.115648, 1.3208, 3.34166, 4.68154, 0.114923, -3.13864, -0.229845, -4.68282, 3.34325, -1.32048, -0.114923, -3.13864, 0.229845, 0.230676, -3.13763, -0.114886, 0.230676, -3.13763, 0.114886, 0.115648, 2.53837, -4.30173, -0.114923, -3.13864, -0.229845, 0.114923, -3.13864, 0.229845, -0.230676, -3.13763, 0.114886, -1.71897, 2.61692, 4.01153, -1.71897, 2.61691, -4.01152, -1.03801, 2.98041, 4.49896, -1.03801, 2.98041, -4.49897, -0.724197, 3.36082, -4.82924, -2.98923, 3.32882, -3.82644, -0.115627, 0.0963667, 2.55745, -0.814091, -2.34434, 0.115648, 3.13888, 0.910383, -0.115648, -0.230676, -3.13763, -0.114886 )

[sub_resource type="SphereMesh" id=15]
radius = 0.1
height = 0.2
radial_segments = 32

[sub_resource type="SpatialMaterial" id=16]

[sub_resource type="CubeMesh" id=19]

[sub_resource type="CubeMesh" id=18]

[sub_resource type="SphereMesh" id=20]

[sub_resource type="SpatialMaterial" id=21]
albedo_color = Color( 0.47451, 0.47451, 0.47451, 1 )

[sub_resource type="CubeMesh" id=22]

[sub_resource type="ProceduralSky" id=25]

[sub_resource type="Environment" id=26]
background_mode = 2
background_sky = SubResource( 25 )
adjustment_enabled = true

[sub_resource type="BoxShape" id=27]

[sub_resource type="CubeMesh" id=23]
size = Vector3( 2, 20, 100 )

[sub_resource type="ConcavePolygonShape" id=24]
data = PoolVector3Array( -1, 10, 50, 1, 10, 50, -1, -10, 50, 1, 10, 50, 1, -10, 50, -1, -10, 50, 1, 10, -50, -1, 10, -50, 1, -10, -50, -1, 10, -50, -1, -10, -50, 1, -10, -50, 1, 10, 50, 1, 10, -50, 1, -10, 50, 1, 10, -50, 1, -10, -50, 1, -10, 50, -1, 10, -50, -1, 10, 50, -1, -10, -50, -1, 10, 50, -1, -10, 50, -1, -10, -50, 1, 10, 50, -1, 10, 50, 1, 10, -50, -1, 10, 50, -1, 10, -50, 1, 10, -50, -1, -10, 50, 1, -10, 50, -1, -10, -50, 1, -10, 50, 1, -10, -50, -1, -10, -50 )

[sub_resource type="BoxShape" id=28]

[sub_resource type="CubeMesh" id=29]

[node name="Spatial" type="Spatial"]

[node name="Floor" type="MeshInstance" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.473451, 0 )
mesh = SubResource( 1 )
material/0 = SubResource( 8 )

[node name="Floor" type="StaticBody" parent="Floor"]

[node name="CollisionShape" type="CollisionShape" parent="Floor/Floor"]
shape = SubResource( 10 )

[node name="CameraGimbal" type="Spatial" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.184064, -0.495725 )
script = ExtResource( 6 )
target = NodePath("../fossbot/camera_target")
invert_y = true

[node name="InnerGimbal" type="Spatial" parent="CameraGimbal"]

[node name="Camera" type="Camera" parent="CameraGimbal/InnerGimbal"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.469, 4 )

[node name="fossbot" type="VehicleBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -2.03734, -0.719398 )
mass = 100.0
script = ExtResource( 1 )
horizontal_ground = false

[node name="car-body" type="MeshInstance" parent="fossbot"]
transform = Transform( 0.012, 0, 0, 0, -5.24537e-10, -0.012, 0, 0.012, -5.24537e-10, 0, 2.2793, 0.598231 )
mesh = ExtResource( 3 )

[node name="CollisionShape" type="CollisionShape" parent="fossbot"]
transform = Transform( 1.5, 0, 8.14905e-11, 0, 1, 0, -1.74623e-10, 0, 0.7, 0, 2.34139, 0.602239 )
shape = SubResource( 4 )

[node name="caste-wheel-skin" type="MeshInstance" parent="fossbot"]
transform = Transform( 3.49691e-08, 0.7, -1.35896e-07, 0.8, -3.0598e-08, -5.22346e-22, -5.28019e-15, -1.05697e-07, -0.9, 0, 2.2284, 1.2504 )
mesh = SubResource( 9 )
skeleton = NodePath("")
material/0 = SubResource( 17 )

[node name="front-right-wheel" type="VehicleWheel" parent="fossbot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.22, 2.478, 0 )
use_as_traction = true
wheel_roll_influence = 0.0
wheel_radius = 0.4
suspension_travel = 0.1
suspension_stiffness = 60.0
damping_compression = 3.0
damping_relaxation = 10.0

[node name="wheel-skin" type="MeshInstance" parent="fossbot/front-right-wheel"]
transform = Transform( -5.24537e-10, -0.012, 0, 0.012, -5.24537e-10, 0, 0, 0, 0.012, -0.25, 0, 0 )
mesh = ExtResource( 4 )

[node name="front-left-wheel" type="VehicleWheel" parent="fossbot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.22, 2.478, 0 )
use_as_traction = true
wheel_roll_influence = 0.0
wheel_radius = 0.4
suspension_travel = 0.1
suspension_stiffness = 60.0
damping_compression = 3.0
damping_relaxation = 10.0

[node name="wheel-skin" type="MeshInstance" parent="fossbot/front-left-wheel"]
transform = Transform( 5.24537e-10, 0.012, -1.04907e-09, 0.012, -5.24537e-10, 0, -4.58565e-17, -1.04907e-09, -0.012, 0.25, 0, 0 )
mesh = ExtResource( 4 )
skeleton = NodePath("../../front-right-wheel")

[node name="caster-wheel" type="VehicleWheel" parent="fossbot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.28199, 1.34494 )
wheel_roll_influence = 0.0
wheel_radius = 0.2
wheel_friction_slip = 0.0
suspension_stiffness = 30.0
damping_compression = 20.0
damping_relaxation = 21.0

[node name="dummy-wheel" type="VehicleWheel" parent="fossbot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.282, -0.4 )
wheel_roll_influence = 0.0
wheel_radius = 0.2
wheel_friction_slip = 0.0
suspension_stiffness = 100.0
damping_compression = 20.0
damping_relaxation = 30.0

[node name="ultrasonic" type="Area" parent="fossbot"]
transform = Transform( 0.999998, 0, 0, 0, 1, 0, 0, 0, 0.999998, 0, 3.0244, -3.6806 )
collision_layer = 128
collision_mask = 128

[node name="MeshInstance" type="MeshInstance" parent="fossbot/ultrasonic"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0 )
visible = false
mesh = SubResource( 11 )

[node name="CollisionShape" type="CollisionShape" parent="fossbot/ultrasonic"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0 )
shape = SubResource( 12 )

[node name="led" type="MeshInstance" parent="fossbot"]
transform = Transform( 0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0.872, 2.9194, -0.365602 )
mesh = SubResource( 15 )
material/0 = SubResource( 16 )

[node name="ledlight" type="SpotLight" parent="fossbot/led"]
light_color = Color( 0, 0, 0, 1 )

[node name="noise_btn" type="Button" parent="fossbot"]
margin_left = 18.0
margin_top = 16.0
margin_right = 105.0
margin_bottom = 51.0
text = "Make Noise"
icon_align = 1

[node name="timer_label" type="Label" parent="fossbot"]
margin_left = 898.0
margin_top = 17.0
margin_right = 1006.0
margin_bottom = 38.0
custom_colors/font_color = Color( 0, 0, 0, 1 )
custom_colors/font_outline_modulate = Color( 1, 1, 1, 1 )
text = "00 : 00 : 00 : 000"
align = 1

[node name="LeftSensor" type="MeshInstance" parent="fossbot"]
transform = Transform( 0.02, 0, 0, 0, 0.05, 0, 0, 0, 0.02, -0.421197, 2.3228, -0.282552 )
mesh = SubResource( 19 )

[node name="LeftContainer" type="ViewportContainer" parent="fossbot/LeftSensor"]
show_behind_parent = true
margin_left = 27.0
margin_top = -89.0
margin_right = 91.0
margin_bottom = -25.0
stretch = true

[node name="Viewport" type="Viewport" parent="fossbot/LeftSensor/LeftContainer"]
size = Vector2( 64, 64 )
handle_input_locally = false
render_target_update_mode = 3

[node name="LeftSensor" type="Camera" parent="fossbot/LeftSensor/LeftContainer/Viewport"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -0.42, 0.326, -1 )
projection = 1
fov = 33.4
size = 0.075

[node name="TestInstance" type="MeshInstance" parent="fossbot/LeftSensor/LeftContainer/Viewport/LeftSensor"]
transform = Transform( 0.03, 0, 0, 0, 0.01, -1.06581e-14, 0, 1.11022e-16, 1, 0, 0, 0.331466 )
visible = false
mesh = SubResource( 18 )

[node name="MiddleSensor" type="MeshInstance" parent="fossbot"]
transform = Transform( 0.02, 0, 0, 0, 0.05, 0, 0, 0, 0.02, -0.00107528, 2.3228, -0.282552 )
mesh = SubResource( 19 )

[node name="MiddleContainer" type="ViewportContainer" parent="fossbot/MiddleSensor"]
show_behind_parent = true
margin_left = 117.0
margin_top = -90.0
margin_right = 181.0
margin_bottom = -26.0
stretch = true

[node name="Viewport" type="Viewport" parent="fossbot/MiddleSensor/MiddleContainer"]
size = Vector2( 64, 64 )
handle_input_locally = false
render_target_update_mode = 3

[node name="MiddleSensor" type="Camera" parent="fossbot/MiddleSensor/MiddleContainer/Viewport"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0.325961, -1 )
projection = 1
fov = 33.4
size = 0.075

[node name="TestInstance" type="MeshInstance" parent="fossbot/MiddleSensor/MiddleContainer/Viewport/MiddleSensor"]
transform = Transform( 0.03, 0, 0, 0, 0.01, -1.06581e-14, 0, 1.11022e-16, 1, -0.00071606, 0, 0.331466 )
visible = false
mesh = SubResource( 18 )
skeleton = NodePath("../../../../../LeftSensor/LeftContainer/Viewport/LeftSensor")

[node name="RightSensor" type="MeshInstance" parent="fossbot"]
transform = Transform( 0.02, 0, 0, 0, 0.05, 0, 0, 0, 0.02, 0.41504, 2.3228, -0.282552 )
mesh = SubResource( 19 )

[node name="RightContainer" type="ViewportContainer" parent="fossbot/RightSensor"]
show_behind_parent = true
margin_left = 213.0
margin_top = -90.0
margin_right = 277.0
margin_bottom = -26.0
stretch = true

[node name="Viewport" type="Viewport" parent="fossbot/RightSensor/RightContainer"]
size = Vector2( 64, 64 )
handle_input_locally = false
render_target_update_mode = 3

[node name="RightSensor" type="Camera" parent="fossbot/RightSensor/RightContainer/Viewport"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0.413, 0.326, -1 )
projection = 1
fov = 33.4
size = 0.075

[node name="TestInstance" type="MeshInstance" parent="fossbot/RightSensor/RightContainer/Viewport/RightSensor"]
transform = Transform( 0.03, 0, 0, 0, 0.01, -1.06581e-14, 0, 1.11022e-16, 1, 0.00181144, 0, 0.331466 )
visible = false
mesh = SubResource( 18 )
skeleton = NodePath("../../../../../LeftSensor/LeftContainer/Viewport/LeftSensor")

[node name="LightSensor" type="MeshInstance" parent="fossbot"]
transform = Transform( 0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, -0.856, 2.9234, -0.365332 )
mesh = SubResource( 20 )
material/0 = SubResource( 21 )

[node name="LightContainer" type="ViewportContainer" parent="fossbot/LightSensor"]
show_behind_parent = true
margin_left = 309.0
margin_top = -90.0
margin_right = 373.0
margin_bottom = -26.0
stretch = true

[node name="Viewport" type="Viewport" parent="fossbot/LightSensor/LightContainer"]
size = Vector2( 64, 64 )
handle_input_locally = false
render_target_update_mode = 3

[node name="LightSensor" type="Camera" parent="fossbot/LightSensor/LightContainer/Viewport"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.857298, 1.01013, -1.14028 )
fov = 33.4
size = 0.075

[node name="TestInstance" type="MeshInstance" parent="fossbot/LightSensor/LightContainer/Viewport/LightSensor"]
transform = Transform( 0.01, 0, 0, 0, 0.01, 0, 0, 0, 1, 0, 0, -0.470422 )
visible = false
mesh = SubResource( 22 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="fossbot"]
environment = SubResource( 26 )
script = ExtResource( 5 )

[node name="BrightnessSlider" type="HSlider" parent="fossbot/WorldEnvironment"]
margin_left = 352.0
margin_top = 13.0
margin_right = 707.0
margin_bottom = 29.0
value = 50.0

[node name="rotation_check" type="Area" parent="fossbot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.50619, 0.719958 )

[node name="CollisionShape" type="CollisionShape" parent="fossbot/rotation_check"]
transform = Transform( 1.5, 0, 0, 0, 0.22, 0, 0, 0, 1.1, 0, -0.485, -0.146101 )
shape = SubResource( 27 )

[node name="camera_target" type="Spatial" parent="fossbot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.91032, 0.525291 )

[node name="Bound" type="MeshInstance" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 49.4633, 8.57741, 0 )
visible = false
mesh = SubResource( 23 )

[node name="StaticBody" type="StaticBody" parent="Bound"]

[node name="CollisionShape" type="CollisionShape" parent="Bound/StaticBody"]
shape = SubResource( 24 )

[node name="Bound2" type="MeshInstance" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -49.4622, 8.57741, 0 )
visible = false
mesh = SubResource( 23 )

[node name="StaticBody" type="StaticBody" parent="Bound2"]

[node name="CollisionShape" type="CollisionShape" parent="Bound2/StaticBody"]
shape = SubResource( 24 )

[node name="Bound3" type="MeshInstance" parent="."]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 8.577, -49.9423 )
visible = false
mesh = SubResource( 23 )

[node name="StaticBody" type="StaticBody" parent="Bound3"]

[node name="CollisionShape" type="CollisionShape" parent="Bound3/StaticBody"]
shape = SubResource( 24 )

[node name="Bound4" type="MeshInstance" parent="."]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 8.577, 49.3659 )
visible = false
mesh = SubResource( 23 )

[node name="StaticBody" type="StaticBody" parent="Bound4"]

[node name="CollisionShape" type="CollisionShape" parent="Bound4/StaticBody"]
shape = SubResource( 24 )

[node name="obstacle1" type="RigidBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.979569, 0.32745, -4.59893 )
collision_mask = 129
mass = 50.0

[node name="obstacle" type="CollisionShape" parent="obstacle1"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.673131, -0.540737 )
shape = SubResource( 28 )

[node name="MeshInstance" type="MeshInstance" parent="obstacle1/obstacle"]
mesh = SubResource( 29 )

[node name="obstacle2" type="RigidBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.40371, 0.32745, -7.07384 )
collision_mask = 129
mass = 50.0

[node name="obstacle" type="CollisionShape" parent="obstacle2"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.673131, -0.540737 )
shape = SubResource( 28 )

[node name="MeshInstance" type="MeshInstance" parent="obstacle2/obstacle"]
mesh = SubResource( 29 )

[connection signal="pressed" from="fossbot/noise_btn" to="fossbot" method="make_noise_btn"]
[connection signal="value_changed" from="fossbot/WorldEnvironment/BrightnessSlider" to="fossbot/WorldEnvironment" method="_on_BrightnessSlider_value_changed"]
